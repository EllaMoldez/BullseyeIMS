<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
	th:replace="~{fragments/layout :: layout(~{::title}, ~{::#contents}, ~{::script})}">
<head>
<title>Create Order</title>
</head>
<body>
	<div id="contents">
		<form onsubmit="submitOrderForm(event)" th:action="@{/showCart}"
			th:object="${currentOrder}" method="post">
			<input type="hidden" th:field="*{employee.empId}">
			<div
				class="d-flex justify-content-between flex-wrap align-items-center pt-3 pb-2 mb-3 border-bottom">
				<div>
					<h2 class="h2"
						th:text="${currentOrder.orderId} ? 'Updating order' : _">Creating
						order</h2>
					<h6 class="h6" th:if="${currentOrder.orderId} != null"
						th:text="|Order no.: ${currentOrder.oId}|">Order no.:
						0123456789</h6>
					<h6 class="h6"
						th:text="|Employee: *{employee.empFirstName} *{employee.empLastName}|">
						Customer: Mike Wise</h6>
				</div>
				<div class="btn-toolbar gap-1">
					<div id="sort-menu"
						th:replace="~{fragments/sort-menu :: sort-menu('oId-Order Number, employee-Employee, price-Price')}"></div>
					<a onclick="cancelOrder()" class="btn btn-sm btn-outline-secondary">
						<i class="bi bi-trash"></i>&nbsp;Cancel
					</a>
					<button type="submit"
						class="btn btn-sm btn-outline-secondary position-relative me-3 me-sm-5">
						<i class="bi bi-cart3"></i>&nbsp;Cart <span id="cart-total"
							class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">0.00</span>
					</button>
				</div>
			</div>
		</form>
		<div class="row">
			<div class="col-md-4">
				<div
					th:replace="~{fragments/search-bar :: search-bar(@{/createOrder}, ~{::input-search})}">
					<input th:ref="input-search" type="hidden" name="employeeId"
						th:value="${currentOrder.employee.empId}">
				</div>
			</div>
		</div>
		<div class="table-responsive">
			<table class="table table-striped table-sm"
				onclick="handleCounter(event)">
				<thead>
					<tr>
						<th scope="col" class="w-auto">#</th>
						<th scope="col" class="w-50">Name</th>
						<th scope="col" class="w-25">Price</th>
						<th scope="col" class="w-auto">Actions</th>
					</tr>
				</thead>
				<tbody>
					<tr th:if="${#lists.isEmpty(product)}">
						<td colspan="4">No products</td>
					</tr>
					<tr th:each="product, status : ${product}">
						<td th:text="${status.count}">1</td>
						<td th:text="${product.prodName}">Product Name</td>
						<td th:id="|product-price-${product.prodId}|"
							th:attr="data-raw-price=${product.prodPrice}"
							th:text="${#numbers.formatDecimal(product.prodPrice, 1, 'DEFAULT', 2, 'DEFAULT')}">399.99
						</td>
						<td>
							<div class="d-flex justify-content-center align-items-center">
								<a href="#" class="link-secondary"><i
									th:id="|product-dash-${product.prodId}|"
									class="bi bi-dash-circle-fill"></i></a> <input type="number"
									th:id="|product-counter-${product.prodId}|"
									onkeyup="handleCounter(event)" class="product-counter"
									value="0"> <a href="#" class="link-secondary"><i
									th:id="|product-plus-${product.prodId}|"
									class="bi bi-plus-circle-fill"></i></a>
							</div>
						</td>
					</tr>
				</tbody>
			</table>
		</div>
		<div class="text-center text-secondary mb-3">
			<div th:replace="~{fragments/pagination :: pagination}"></div>
		</div>
	</div>
	<script th:inline="javascript">
		const currentEmployeeId = /*[[${currentOrder.employee.empId}]]*/1;
	</script>
	<script type="text/javascript" th:src="@{/js/create-order.js}"></script>
</body>
</html>